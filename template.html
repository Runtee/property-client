<div>

    <form class="pt-5" (ngSubmit)="onSubmit($event)" (keydown.enter)="$event.preventDefault()" novalidate>
 
        <header class="p-5 mb-5">
 
            <div class="relative">
 
                <div class="absolute top-0 left-0">
 
                    <app-back></app-back>
 
                </div>
 
                <h2 class="font-bold text-lg text-center">Fill this form to proceed</h2>
 
            </div>
 
        </header>
 
        <main class="p-5 pt-0">
 
            <!-- Personal Details -->
 
            <div class="mb-10">
 
                <h2 class="font-bold mb-5">Personal Details *</h2>
 
                <div class="mb-4 flex gap-2 w-full">
 
                    <div class="w-full">
 
                        <h3 class="text-sm font-medium mb-2">
 
                            Email
 
                        </h3>
 
                        <input [(ngModel)]="formDetails.email" name="email" #email="ngModel"
 
                            class="border border-main-dark rounded-md outline-none w-full py-3 px-4 text-sm"
 
                            type="email" required email>
 
                        <div *ngIf="isFormSubmitted && formErrors['email']" class="text-red-500 text-xs mt-1">
 
                            {{ formErrors['email'] }}
 
                        </div>
 
                    </div>
 
                    <div class="w-full">
 
                        <h3 class="text-sm font-medium mb-2">
 
                            Number
 
                        </h3>
 
                        <input [(ngModel)]="formDetails.number" name="number" #number="ngModel"
 
                            class="border border-main-dark rounded-md outline-none w-full py-3 px-4 text-sm" type="text"
 
                            required>
 
                        <div *ngIf="isFormSubmitted && formErrors['number']" class="text-red-500 text-xs mt-1">
 
                            {{ formErrors['number'] }}
 
                        </div>
 
                    </div>
 
                </div>
 
                <div class="mb-4">
 
                    <h3 class="text-sm font-medium mb-2">
 
                        Name
 
                    </h3>
 
                    <input [(ngModel)]="formDetails.name" name="name" #name="ngModel"
 
                        class="border border-main-dark rounded-md outline-none w-full py-3 px-4 text-sm" type="text"
 
                        required>
 
                    <div *ngIf="isFormSubmitted && formErrors['name']" class="text-red-500 text-xs mt-1">
 
                        {{ formErrors['name'] }}
 
                    </div>
 
                </div>
 
                <div class="mb-5">
 
                    <h3 class="text-sm font-medium mb-2">
 
                        Address
 
                    </h3>
 
                    <input [(ngModel)]="formDetails.address" name="address" #address="ngModel"
 
                        class="border border-main-dark rounded-md outline-none w-full py-3 px-4 text-sm" type="text"
 
                        required>
 
                    <div *ngIf="isFormSubmitted && formErrors['address']" class="text-red-500 text-xs mt-1">
 
                        {{ formErrors['address'] }}
 
                    </div>
 
                </div>
 
            </div>
 
 
            <!-- Property Details -->
 
            <div class="mb-10">
 
                <h2 class="font-bold mb-5">Property Details *</h2>
 
                <div class="mb-4">
 
                    <h3 class="text-sm font-medium mb-2">
 
                        Title
 
                    </h3>
 
                    <input [(ngModel)]="formDetails.title" name="title" #title="ngModel"
 
                        class="border border-main-dark rounded-md outline-none w-full py-3 px-4 text-sm" type="text"
 
                        required maxlength="40">
 
                    <div *ngIf="isFormSubmitted && formErrors['title']" class="text-red-500 text-xs mt-1">
 
                        {{ formErrors['title'] }}
 
                    </div>
 
                </div>
 
                <div class="mb-4">
 
                    <h3 class="text-sm font-medium mb-2">
 
                        Description
 
                    </h3>
 
                    <textarea [(ngModel)]="formDetails.description" name="description" #description="ngModel"
 
                        class="border border-main-dark rounded-md outline-none w-full py-3 px-4 text-sm" type="text"
 
                        required></textarea>
 
                    <div *ngIf="isFormSubmitted && formErrors['description']" class="text-red-500 text-xs mt-1">
 
                        {{ formErrors['description'] }}
 
                    </div>
 
                </div>
 
                <div class="mb-4">
 
                    <h3 class="text-sm font-medium mb-2">
 
                        Location (Address)
 
                    </h3>
 
                    <input [(ngModel)]="formDetails.location" name="location" #location="ngModel"
 
                        class="border border-main-dark rounded-md outline-none w-full py-3 px-4 text-sm" type="text"
 
                        required>
 
                    <div *ngIf="isFormSubmitted && formErrors['location']" class="text-red-500 text-xs mt-1">
 
                        {{ formErrors['location'] }}
 
                    </div>
 
                </div>
 
                <div class="mb-4 flex gap-2">
 
                    <div class="w-full">
 
                        <h3 class="text-sm font-medium mb-2">
 
                            City
 
                        </h3>
 
                        <input [(ngModel)]="formDetails.city" name="city" #city="ngModel"
 
                            class="border border-main-dark rounded-md outline-none w-full py-3 px-4 text-sm" type="text"
 
                            required>
 
                        <div *ngIf="isFormSubmitted && formErrors['city']" class="text-red-500 text-xs mt-1">
 
                            {{ formErrors['city'] }}
 
                        </div>
 
                    </div>
 
                    <div class="w-full">
 
                        <h3 class="text-sm font-medium mb-2">
 
                            State
 
                        </h3>
 
                        <input [(ngModel)]="formDetails.state" name="state" #state="ngModel"
 
                            class="border border-main-dark rounded-md outline-none w-full py-3 px-4 text-sm" type="text"
 
                            required list="state">
 
                        <datalist id="state">
 
                            <option *ngFor="let state of validStates ">{{state}}</option>
 
                        </datalist>
 
                        <div *ngIf="isFormSubmitted && formErrors['state']" class="text-red-500 text-xs mt-1">
 
                            {{ formErrors['state'] }}
 
                        </div>
 
                    </div>
 
                </div>
 
                <div class="mb-6 flex gap-2">
 
                    <div class="w-full">
 
                        <h3 class="text-sm font-medium mb-2">
 
                            Category
 
                        </h3>
 
                        <select [(ngModel)]="formDetails.category" name="category" #category="ngModel"
 
                            class="bg-white border border-main-dark rounded-md outline-none w-full py-3 px-4 text-sm"
 
                            required>
 
                            <option value="" disabled>Select Category</option>
 
                            <option value="land">Land</option>
 
                            <option value="real_estate">Real Estate</option>
 
                            <option value="rent">Rent</option>
 
                        </select>
 
                        <div *ngIf="isFormSubmitted && formErrors['category']" class="text-red-500 text-xs mt-1">
 
                            {{ formErrors['category'] }}
 
                        </div>
 
                    </div>
 
                    <div class="w-full">
 
                        <h3 class="text-sm font-medium mb-2">
 
                            Price
 
                        </h3>
 
                        <input [(ngModel)]="formDetails.price" name="price" #price="ngModel"
 
                            class="border border-main-dark rounded-md outline-none w-full py-3 px-4 text-sm"
 
                            type="number" required>
 
                        <div *ngIf="isFormSubmitted && formErrors['price']" class="text-red-500 text-xs mt-1">
 
                            {{ formErrors['price'] }}
 
                        </div>
 
                    </div>
 
                </div>
 
 
                <!-- cloning -->
 
 
                <div class="mb-5">
 
                    <div class="flex justify-between items-center">
 
                        <h2 class="font-bold">Cloning</h2>
 
 
                        <label class="relative inline-flex items-center mb-5 cursor-pointer">
 
                            <input type="checkbox" class="sr-only peer" [(ngModel)]="formDetails.cloningEnabled"
 
                            (change)="toggleCloning()" name="cloningEnabled">
 
                            <div
 
                                class="w-10 h-4 bg-gray-200 peer-focus:outline-none peer-focus:ring-3 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[-2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:w-5 after:h-5 after:transition-all peer-checked:bg-blue-600">
 
                            </div>
 
                        </label>
 
 
                    </div>
 
                    <!-- if the switch toggled then this div should show -->
 
                    <div *ngIf="formDetails.cloningEnabled">
 
                    <p class="text-xs text-gray-500 mx-[4px] mb-5">
 
                        If cloning is enabled, anyone with your cloned link can earn a
 
                        <input required class="h-5 w-6 inline-block border font-bold text-center border-main-dark"
 
                            [(ngModel)]="formDetails.cloningPercentage" name="cloningPercentage"> % profit for successful referrals
 
                    </p>
 
                    <div class="mb-5 w-full">
 
                        <button type="button" class="flex gap-5 w-full" (click)="selectPublic()">
 
                            <img src="assets/images/people.svg" class="" *ngIf="formDetails.cloningType=='public'">
 
                            <img src="assets/images/people-2.svg" class="" *ngIf="formDetails.cloningType!='public'">
 
                            <div class="" [ngClass]="formDetails.cloningType!=='public' ? 'text-gray-700' : 'text-main-dark'">
 
                                <h2 class="font-bold text-sm text-left">Public Cloning</h2>
 
                                <h2 class="text-xs">Anybody can clone this ad</h2>
 
                            </div>
 
                        </button>
 
                        <div class="w-full h-[1px] border border-gray-300 my-3"></div>
 
                        <button (click)="toggleSelectPeople()" type="button" class="flex justify-between w-full items-center mb-5">
 
                            <div class="flex gap-5">
 
                                <img src="assets/images/user-add.svg" class="" *ngIf="formDetails.cloningType!=='private'">
 
                                <img src="assets/images/user-add-2.svg" class="" *ngIf="formDetails.cloningType=='private'">
 
                                <div class="" [ngClass]="formDetails.cloningType!=='private' ? 'text-gray-700' : 'text-main-dark'">
 
                                <h2 class="font-bold text-sm text-left">Specific people</h2>
 
                                <h2 class="text-xs">Choose who you would like to let clone</h2>
 
                            </div>
 
                        </div>
 
                            <button type="button">
 
                            <img src="assets/images/arrow-right.svg" class="ml-auto" >
 
                            <!-- <img src="assets/images/arrow-up.svg" class="ml-auto" *ngIf="showSelectPeople"> -->
 
                        </button>                          
 
                        </button>
 
                        <div class="" *ngIf="showSelectPeople">
 
                            <!-- <app-email-tags [(emails)]="myInitialEmails"></app-email-tags> -->
 
                            <app-email-tags [emails]="formDetails.specificCloners" (emailsChange)="onEmailsChange($event)"></app-email-tags>
 
 
                            <!-- <textarea class="w-full px-3 py-2 h-32 border border-main-dark rounded-2xl"
 
                                [(ngModel)]="formDetails.specificCloners"
 
                                placeholder="Please input the emails of the desired cloners"></textarea> -->
 
                        </div>
 
                    </div>
 
                </div>
 
                </div>
 
 
 
                <!-- account details -->
 
                <div class="">
 
                    <div class="flex justify-between items-center">
 
                        <h2 class="font-bold">Account details</h2>
 
                        <button type="button" (click)="toggleAccountDetails()">
 
                            <img src="assets/images/arrow-right.svg" class="ml-auto cursor-pointer" *ngIf="!showAccountDetails">
 
                            <img src="assets/images/arrow-up.svg" class="ml-auto cursor-pointer" *ngIf="showAccountDetails">
 
                        </button>
 
                    </div>
 
                    <!-- if the button is clicked then this div should show -->
 
                    <div *ngIf="showAccountDetails">
 
                    <p class="text-xs text-main-dark mt-1">
 
                        This is the account that will receive the payment once the transaction is done. You can skip for
 
                        now if
 
                        you are not sure of the details.
 
                    </p>
 
                    <p class="text-xs text-main-dark mb-5">
 
                        Please make sure the account here and the name on the Certificate of ownership (CofO) is the
 
                        same
 
                    </p>
 
                    <div class="mb-4">
 
                        <h3 class="text-sm font-medium mb-2">
 
                            Account Name
 
                        </h3>
 
                        <input [(ngModel)]="formDetails.accountName" name="accountName" #accountName="ngModel"
 
                            class="border border-main-dark rounded-md outline-none w-full py-3 px-4 text-sm" type="text"
 
                            placeholder="Account Name" required>
 
                        <div *ngIf="isFormSubmitted && formErrors['accountName']" class="text-red-500 text-xs mt-1">
 
                            {{ formErrors['accountName'] }}
 
                        </div>
 
                    </div>
 
                    <div class="mb-4">
 
                        <h3 class="text-sm font-medium mb-2">
 
                            Account Number
 
                        </h3>
 
                        <input [(ngModel)]="formDetails.accountNumber" name="accountNumber" #accountNumber="ngModel"
 
                            class="border border-main-dark rounded-md outline-none w-full py-3 px-4 text-sm" type="text"
 
                            placeholder="Account Number" required>
 
                        <div *ngIf="isFormSubmitted && formErrors['accountNumber']" class="text-red-500 text-xs mt-1">
 
                            {{ formErrors['accountNumber'] }}
 
                        </div>
 
                    </div>
 
                    <div class="mb-4">
 
                        <h3 class="text-sm font-medium mb-2">
 
                            Bank Name
 
                        </h3>
 
                        <input [(ngModel)]="formDetails.bankName" name="bankName" #bankName="ngModel"
 
                            class="border border-main-dark rounded-md outline-none w-full py-3 px-4 text-sm" type="text"
 
                            placeholder="Bank name here" required>
 
                        <div *ngIf="isFormSubmitted && formErrors['bankName']" class="text-red-500 text-xs mt-1">
 
                            {{ formErrors['bankName'] }}
 
                        </div>
 
                    </div>
 
                </div>
 
                </div>
 
            </div>
 
 
            <div class="flex flex-col gap-4">
 
                <button type="submit"
 
                    class="w-full text-center py-3 border rounded-md font-bold bg-main-dark text-white border-main-dark">
 
                    Next
 
                </button>
 
                <button type="button" (click)="goBack()"
 
                    class="w-full text-center py-3 border rounded-md font-bold text-main-dark border-main-dark">
 
                    Cancel
 
                </button>
 
            </div>
 
        </main>
 
    </form>
 
 </div>
 
 
 
 
 import { Component, EventEmitter, Output } from '@angular/core';
 
 import { MainService } from '../main.service';
 
 import { Router } from '@angular/router';
 
 import { Location } from '@angular/common';
 
 
 @Component({
 
  selector: 'app-upload-text',
 
  templateUrl: './upload-text.component.html'
 
 })
 
 export class UploadTextComponent {
 
  @Output() next = new EventEmitter<void>();
 
  constructor(private mainService: MainService, private router: Router, private location: Location) { }
 
  formDetails: any = {
 
    email: "",
 
    number: "",
 
    name: "",
 
    address: "",
 
    title: '',
 
    description: '',
 
    location: '',
 
    city: '',
 
    state: '',
 
    category: '',
 
    price: null,
 
    cloningEnabled: false,
 
    cloningPercentage: null,
 
    cloningType:'public',
 
    specificCloners: [],
 
    accountName: '',
 
    accountNumber: '',
 
    bankName: '',
 
  };
 
  formErrors: any = {};
 
  validStates = ['Abia', 'Adamawa', 'Akwa Ibom', 'Anambra', 'Bauchi', 'Bayelsa', 'Benue', 'Borno', 'Cross River', 'Delta', 'Ebonyi', 'Edo', 'Ekiti', 'Enugu', 'Gombe', 'Imo', 'Jigawa', 'Kaduna', 'Kano', 'Katsina', 'Kebbi', 'Kogi', 'Kwara', 'Lagos', 'Nasarawa', 'Niger', 'Ogun', 'Ondo', 'Osun', 'Oyo', 'Plateau', 'Rivers', 'Sokoto', 'Taraba', 'Yobe', 'Zamfara', 'FCT'];
 
  isFormSubmitted: boolean = false
 
  showCloningDetails: boolean = false;
 
  showAccountDetails: boolean = false;
 
  showSelectPeople: boolean = false;
 
 
  goBack(): void {
 
 
    this.location.back();
 
  }
 
  selectPublic(){
 
    this.formDetails.cloningType = "public"
 
  }
 
 
  toggleCloning() {
 
    this.formDetails.cloningEnabled = !this.formDetails.cloningEnabled;
 
  }
 
 
  toggleAccountDetails() {
 
    this.showAccountDetails = !this.showAccountDetails;
 
  }
 
 
  toggleSelectPeople(){
 
    this.formDetails.cloningType = "private"
 
    this.showSelectPeople = !this.showSelectPeople;
 
  }
 
 
  onEmailsChange(updatedEmails: string[]) {
 
 
 
    this.formDetails.specificCloners = [...updatedEmails];
 
    // Ensure that newEmail is cleared to avoid duplicate entry issues
 
    // this.formDetails.specificCloners = [];
 
  }
 
 
 
 
  ngOnInit(): void {
 
    false
 
    // Retrieve data from localStorage and populate formDetails
 
    const storedFormDetails = localStorage.getItem('formDetails');
 
    if (storedFormDetails) {
 
      this.formDetails = JSON.parse(storedFormDetails);
 
    }
 
  }
 
  onSubmit(e:Event) {   
 
    e.preventDefault()
 
    // Reset form errors
 
    this.formErrors = {};
 
    this.isFormSubmitted = true
 
    // Validate personal details
 
    this.validateRequired('email', 'Email is required.');
 
    this.validateRequired('number', 'Number is required.');
 
    this.validateRequired('name', 'Name is required.');
 
    this.validateRequired('address', 'Address is required.');
 
 
    // Validate property details
 
    this.validateRequired('title', 'Title is required.');
 
    this.validateMaxLength('title', 40, 'Title cannot exceed 40 characters.');
 
    this.validateRequired('description', 'Description is required.');
 
    this.validateRequired('location', 'Location is required.');
 
    this.validateRequired('city', 'City is required.');
 
    this.validateRequired('state', 'State is required.');
 
    this.validateState('state', 'Invalid state selected.');
 
    this.validateRequired('category', 'Category is required.');
 
    this.validateRequired('price', 'Price is required.');
 
    this.validatePositiveNumber('price', 'Price must be a positive number.');
 
 
    // If there are no form errors, proceed with form submission
 
    if (Object.keys(this.formErrors).length === 0) {
 
      // Handle form submission logic here
 
      console.log('Form submitted with data:', this.formDetails);
 
      this.mainService.setFormData(this.formDetails);
 
      localStorage.setItem('formDetails', JSON.stringify(this.formDetails));
 
      this.next.emit();
 
      // Navigate to the next screen (UploadMediaComponent)
 
      // this.router.navigate(['/upload-media']);
 
    }
 
  }
 
 
  validateRequired(field: string, errorMessage: string) {
 
    // Use type assertion to tell TypeScript that `this` has an index signature
 
    if (!this.formDetails[field]) {
 
      this.formErrors[field] = errorMessage;
 
    }
 
  }
 
 
  validateMaxLength(field: string, maxLength: number, errorMessage: string) {
 
    // Use type assertion to tell TypeScript that `this` has an index signature
 
    if (this.formDetails[field] && this.formDetails[field].length > maxLength) {
 
      this.formErrors[field] = errorMessage;
 
    }
 
  }
 
 
  validateState(field: string, errorMessage: string) {
 
    if (!this.validStates.includes(this.formDetails[field].trim())) {
 
      this.formErrors[field] = errorMessage;
 
    }
 
  }
 
 
  validatePositiveNumber(field: string, errorMessage: string) {
 
    const number = parseFloat(this.formDetails[field]);
 
    // Use type assertion to tell TypeScript that `this` has an index signature
 
    if (isNaN(number) || number <= 0) {
 
      this.formErrors[field] = errorMessage;
 
    }
 
  }
 
 
 }
 
 
 
 in the code    <div *ngIf="formDetails.cloningEnabled"> and any other section or div that uses*ngif to check if the formdetail.thefeild exists before rendering the component od div gives error because t does not display fast, it only displays if I click on it again 